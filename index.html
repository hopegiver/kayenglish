<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Kay's English Note</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="description" content="ì‹¤ì „ì—ì„œ ë°”ë¡œ ì“°ëŠ” ì˜ì–´ í‘œí˜„ì§‘">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">

  <!-- Theme -->
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/docsify@4/lib/themes/vue.css">

  <!-- Custom styles -->
  <style>
    :root {
      --theme-color: #4CAF50;
      --theme-color-secondary: #2196F3;
    }

    body {
      font-size: 16px;
    }

    .sidebar {
      background-color: #f8f9fa;
    }

    .sidebar > h1 {
      text-align: left;
      margin-left: 40px;
    }

    .sidebar .sidebar-nav {
      padding-left: 20px;
    }

    .app-name,
    .sidebar .app-name-link {
      font-weight: 700 !important;
    }

    .sidebar-nav > ul > li > a {
      font-weight: 500;
    }

    .markdown-section {
      max-width: 900px;
      padding: 30px 30px 40px;
    }

    .markdown-section h1 {
      color: #2c3e50;
      border-bottom: 3px solid var(--theme-color);
      padding-bottom: 10px;
    }

    .markdown-section h2 {
      color: #34495e;
      border-bottom: 2px solid #e0e0e0;
      padding-bottom: 8px;
    }

    .markdown-section h3 {
      color: var(--theme-color);
    }

    .markdown-section code {
      background-color: #f5f5f5;
      padding: 2px 6px;
      border-radius: 3px;
      color: #e91e63;
    }

    .markdown-section pre > code {
      background-color: #f5f5f5;
      color: #333;
    }

    .markdown-section table {
      border-collapse: collapse;
      width: 100%;
      margin: 20px 0;
    }

    .markdown-section table th {
      background-color: var(--theme-color);
      color: white;
      font-weight: 600;
    }

    .markdown-section table tr:nth-child(even) {
      background-color: #f9f9f9;
    }

    .markdown-section blockquote {
      border-left: 4px solid var(--theme-color);
      background-color: #f0f8ff;
      padding: 15px 20px;
      margin: 20px 0;
    }

    .markdown-section details {
      margin: 10px 0;
      padding: 10px;
      border: 1px solid #e0e0e0;
      border-radius: 5px;
      background-color: #fafafa;
    }

    .markdown-section details summary {
      cursor: pointer;
      font-weight: 600;
      color: var(--theme-color);
      padding: 5px;
    }

    .markdown-section details[open] summary {
      border-bottom: 1px solid #e0e0e0;
      margin-bottom: 10px;
    }

    /* Emoji styles */
    .markdown-section .emoji {
      height: 1.2em;
      vertical-align: middle;
    }

    /* Progress checkbox */
    .task-list-item {
      list-style-type: none;
    }

    .task-list-item input {
      margin-right: 8px;
    }

    /* TTS Speaker Button */
    .docsify-copy-code-button {
      position: relative;
    }

    .tts-speaker-button {
      position: absolute;
      top: 0;
      left: 0;
      z-index: 1;
      cursor: pointer;
      padding: 6px 10px;
      font-size: 14px;
      background: #42b983;
      color: white;
      border: none;
      border-radius: 3px;
      opacity: 0;
      transition: opacity 0.3s;
    }

    pre:hover .tts-speaker-button {
      opacity: 1;
    }

    .tts-speaker-button:hover {
      background: #33a372;
    }

    .tts-speaker-button.playing {
      background: #ff6b6b;
    }

    .tts-speaker-button.playing:hover {
      background: #ff5252;
    }
  </style>
</head>
<body>
  <div id="app">Loading...</div>
  <script>
    window.$docsify = {
      name: "Kay's English Note",
      repo: '',
      loadSidebar: true,
      alias: {
        '/.*/_sidebar.md': '/_sidebar.md'
      },
      subMaxLevel: 0,
      auto2top: true,
      homepage: 'README.md',

      // Search plugin
      search: {
        maxAge: 86400000,
        paths: 'auto',
        placeholder: 'ê²€ìƒ‰...',
        noData: 'ê²°ê³¼ ì—†ìŒ',
        depth: 3
      },

      // Pagination
      pagination: {
        previousText: 'ì´ì „',
        nextText: 'ë‹¤ìŒ',
        crossChapter: true,
        crossChapterText: true,
      },

      // Copy code
      copyCode: {
        buttonText: 'ë³µì‚¬',
        errorText: 'ì‹¤íŒ¨',
        successText: 'ì™„ë£Œ'
      },

      // Tabs
      tabs: {
        persist: true,
        sync: true,
        theme: 'classic',
        tabComments: true,
        tabHeadings: true
      },

      // Progress
      progress: {
        position: "top",
        color: "var(--theme-color,#4CAF50)",
        height: "3px",
      },

      // TTS Plugin
      plugins: [
        function(hook, vm) {
          let currentUtterance = null;
          let voicesLoaded = false;

          // ìŒì„± ëª©ë¡ ë¡œë“œ ëŒ€ê¸°
          function loadVoices() {
            return new Promise((resolve) => {
              const voices = window.speechSynthesis.getVoices();
              if (voices.length > 0) {
                voicesLoaded = true;
                resolve(voices);
              } else {
                window.speechSynthesis.onvoiceschanged = () => {
                  voicesLoaded = true;
                  resolve(window.speechSynthesis.getVoices());
                };
              }
            });
          }

          // ì´ˆê¸° ë¡œë“œ
          loadVoices().then(voices => {
            console.log('=== Available Voices ===');
            voices.forEach((voice, index) => {
              console.log(`${index}: ${voice.name} (${voice.lang}) ${voice.localService ? '[Local]' : '[Remote]'}`);
            });
            console.log('=======================');
          });

          // í˜„ì¬ ì¬ìƒ ì¤‘ì¸ ì˜¤ë””ì˜¤
          let currentAudio = null;

          // TTS í•¨ìˆ˜ (ì˜¨ë¼ì¸ API ì‚¬ìš©)
          function speakText(text, button) {
            // ì´ë¯¸ ì¬ìƒ ì¤‘ì´ë©´ ì¤‘ì§€
            if (currentAudio && !currentAudio.paused) {
              currentAudio.pause();
              currentAudio = null;
              if (button) {
                button.textContent = 'ğŸ”Š';
                button.classList.remove('playing');
              }
              return;
            }

            // ì˜ì–´ ë¬¸ì¥ë§Œ ì¶”ì¶œ (í•œê¸€ ì œì™¸)
            const englishOnly = text
              .split('\n')
              .filter(line => /[a-zA-Z]/.test(line) && !/[ê°€-í£]/.test(line))
              .join('. ');

            if (!englishOnly.trim()) {
              alert('ì½ì„ ìˆ˜ ìˆëŠ” ì˜ì–´ í…ìŠ¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.');
              return;
            }

            // í…ìŠ¤íŠ¸ê°€ ë„ˆë¬´ ê¸¸ë©´ ì˜ë¼ë‚´ê¸° (200ì ì œí•œ)
            const textToSpeak = englishOnly.length > 200
              ? englishOnly.substring(0, 200) + '...'
              : englishOnly;

            if (button) {
              button.textContent = 'â¸ï¸';
              button.classList.add('playing');
            }

            console.log('ğŸ”Š Playing TTS (Online):', textToSpeak.substring(0, 50) + '...');

            // Google Translate TTS API ì‚¬ìš©
            const encodedText = encodeURIComponent(textToSpeak);
            const audioUrl = `https://translate.google.com/translate_tts?ie=UTF-8&tl=en&client=tw-ob&q=${encodedText}`;

            const audio = new Audio(audioUrl);
            currentAudio = audio;

            audio.onplay = function() {
              console.log('âœ… TTS started');
            };

            audio.onended = function() {
              console.log('âœ… TTS ended');
              if (button) {
                button.textContent = 'ğŸ”Š';
                button.classList.remove('playing');
              }
              currentAudio = null;
            };

            audio.onerror = function(e) {
              console.error('âŒ TTS Error:', e);
              alert('TTSë¥¼ ì¬ìƒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
              if (button) {
                button.textContent = 'ğŸ”Š';
                button.classList.remove('playing');
              }
              currentAudio = null;
            };

            // ì¬ìƒ
            audio.play().catch(function(error) {
              console.error('Play error:', error);
              if (button) {
                button.textContent = 'ğŸ”Š';
                button.classList.remove('playing');
              }
              currentAudio = null;
            });
          }

          // í˜ì´ì§€ ë Œë”ë§ í›„ ë²„íŠ¼ ì¶”ê°€
          hook.doneEach(function() {
            setTimeout(function() {
              document.querySelectorAll('pre[data-lang]').forEach(function(pre) {
                // ì´ë¯¸ ë²„íŠ¼ì´ ìˆìœ¼ë©´ ìŠ¤í‚µ
                if (pre.querySelector('.tts-speaker-button')) return;

                const code = pre.querySelector('code');
                if (!code) return;

                const text = code.textContent;

                // ì˜ì–´ê°€ í¬í•¨ëœ ì½”ë“œ ë¸”ë¡ë§Œ ì²˜ë¦¬
                if (!/[a-zA-Z]/.test(text)) return;

                const button = document.createElement('button');
                button.className = 'tts-speaker-button';
                button.textContent = 'ğŸ”Š';
                button.title = 'Read aloud (ì˜ì–´ë§Œ ì½ê¸°)';

                button.onclick = function(e) {
                  e.preventDefault();
                  e.stopPropagation();
                  speakText(text, button);
                };

                pre.style.position = 'relative';
                pre.insertBefore(button, pre.firstChild);
              });
            }, 100);
          });

          // í˜ì´ì§€ ì´ë™ ì‹œ TTS ì¤‘ì§€
          hook.beforeEach(function(content) {
            if (currentAudio && !currentAudio.paused) {
              currentAudio.pause();
              currentAudio = null;
            }
            return content;
          });
        }
      ]
    }
  </script>

  <!-- Docsify core -->
  <script src="//cdn.jsdelivr.net/npm/docsify@4"></script>

  <!-- Plugins -->
  <script src="//cdn.jsdelivr.net/npm/docsify/lib/plugins/search.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/docsify-pagination/dist/docsify-pagination.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/docsify-copy-code@2"></script>
  <script src="//cdn.jsdelivr.net/npm/docsify-tabs@1"></script>
  <script src="//cdn.jsdelivr.net/npm/docsify-progress@1"></script>

  <!-- Emoji -->
  <script src="//cdn.jsdelivr.net/npm/docsify/lib/plugins/emoji.min.js"></script>

  <!-- Zoom image -->
  <script src="//cdn.jsdelivr.net/npm/docsify/lib/plugins/zoom-image.min.js"></script>
</body>
</html>
